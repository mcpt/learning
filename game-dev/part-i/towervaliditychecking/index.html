<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.89.4">
<meta name=description content>
<title>Tower Validity Checking :: MCPT Learning Resources</title>
<link href=/css/nucleus.css?1638479108 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1638479108 rel=stylesheet>
<link href=/css/featherlight.min.css?1638479108 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1638479108 rel=stylesheet>
<link href=/css/auto-complete.css?1638479108 rel=stylesheet>
<link href=/css/theme.css?1638479108 rel=stylesheet>
<link href=/css/theme-mcpt.css?1638479108 rel=stylesheet>
<link href=/css/variant.css?1638479108 rel=stylesheet>
<link href=/css/print.css?1638479108 rel=stylesheet media=print>
<link href=/css/p5js.css?1638479108 rel=stylesheet>
<link href=/css/sidebar.css?1638479108 rel=stylesheet>
<script src=/js/p5.min.js></script>
<script src=/js/jquery.min.js?1638479108></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><style></style>
</head>
<body data-url=/game-dev/part-i/towervaliditychecking/>
<nav id=sidebar>
<div id=header-wrapper>
<div id=header>
<a href=/>
<img src=https://mcpt.ca/static/icons/logo.png>
<br>
<span class=subheading>LEARNING</span>
</a>
</div>
<div class=searchbox>
<label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span>
</div>
<script src=/js/lunr.min.js?1638479108></script>
<script src=/js/auto-complete.js?1638479108></script>
<script>var index_url="/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script>
<script src=/js/search.js?1638479108></script>
</div>
<div id=homelinks>
<ul>
<li>
<a class=padding href=/><i class="fas fa-home"></i> Home</a>
</li>
</ul>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=/game-dev/ title="Game Series" class="dd-item parent"><a href=/game-dev/>Game Series</a><ul>
<li data-nav-id=/game-dev/leaderboard/ title=Leaderboard class=dd-item><a href=/game-dev/leaderboard/>Leaderboard</a></li>
<li data-nav-id=/game-dev/part-i/ title="Part I" class="dd-item parent"><a href=/game-dev/part-i/><b>1.</b> Part I</a><ul>
<li data-nav-id=/game-dev/part-i/introduction/ title=Introduction class=dd-item><a href=/game-dev/part-i/introduction/>Introduction</a></li>
<li data-nav-id=/game-dev/part-i/draganddrop/ title="Drag And Drop" class=dd-item><a href=/game-dev/part-i/draganddrop/>Drag And Drop</a></li>
<li data-nav-id=/game-dev/part-i/towers/ title="Rotating Towers" class=dd-item><a href=/game-dev/part-i/towers/>Rotating Towers</a></li>
<li data-nav-id=/game-dev/part-i/pathforballoons/ title="Path For Balloons" class=dd-item><a href=/game-dev/part-i/pathforballoons/>Path For Balloons</a></li>
<li data-nav-id=/game-dev/part-i/challenge/ title="Challenge: Movement" class=dd-item><a href=/game-dev/part-i/challenge/>Challenge: Movement</a></li>
<li data-nav-id=/game-dev/part-i/updatingballoons/ title="Balloon Waves" class=dd-item><a href=/game-dev/part-i/updatingballoons/>Balloon Waves</a></li>
<li data-nav-id=/game-dev/part-i/healthchecking/ title="Health Bar" class=dd-item><a href=/game-dev/part-i/healthchecking/>Health Bar</a></li>
<li data-nav-id=/game-dev/part-i/towervaliditychecking/ title="Tower Validity Checking" class="dd-item active"><a href=/game-dev/part-i/towervaliditychecking/>Tower Validity Checking</a></li></ul></li>
<li data-nav-id=/game-dev/part-ii/ title="Part II" class=dd-item><a href=/game-dev/part-ii/><b>2.</b> Part II</a><ul>
<li data-nav-id=/game-dev/part-ii/introduction/ title=Introduction class=dd-item><a href=/game-dev/part-ii/introduction/>Introduction</a></li>
<li data-nav-id=/game-dev/part-ii/advancedtracking/ title="Advanced Tracking" class=dd-item><a href=/game-dev/part-ii/advancedtracking/>Advanced Tracking</a></li>
<li data-nav-id=/game-dev/part-ii/currency/ title="Currency System" class=dd-item><a href=/game-dev/part-ii/currency/>Currency System</a></li>
<li data-nav-id=/game-dev/part-ii/newtower/ title="New Towers" class=dd-item><a href=/game-dev/part-ii/newtower/>New Towers</a></li>
<li data-nav-id=/game-dev/part-ii/projectiles/ title=Projectiles class=dd-item><a href=/game-dev/part-ii/projectiles/>Projectiles</a></li></ul></li>
<li data-nav-id=/game-dev/part-iii/ title="Part III" class="dd-item alwaysopen"><a href=/game-dev/part-iii/><b>3.</b> Part III</a><ul></ul></li></ul></li>
<li data-nav-id=/game-jam/ title="Game Jam" class=dd-item><a href=/game-jam/>Game Jam</a><ul></ul></li>
<li data-nav-id=/lyon-hacks/ title=LyonHacks class=dd-item><a href=/lyon-hacks/>LyonHacks</a><ul>
<li data-nav-id=/lyon-hacks/season-i/ title="Season I" class="dd-item alwaysopen"><a href=/lyon-hacks/season-i/>Season I</a><ul></ul></li>
<li data-nav-id=/lyon-hacks/season-ii/ title="Season II" class="dd-item alwaysopen"><a href=/lyon-hacks/season-ii/>Season II</a><ul></ul></li></ul></li>
<li data-nav-id=/mentorship/ title=Mentorship class=dd-item><a href=/mentorship/>Mentorship</a><ul></ul></li>
</ul>
<div id=footer><a href=https://mcpt.ca/>
<p>
<object type=image/svg+xml data=/img/footer-icon.svg></object>
mcpt.ca
</p>
</a>
<a href=https://github.com/mcpt/learning><p><i class="fab fa-github-alt"></i> source</p></a>
</div>
</div>
</nav>
<div id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div id=top-bar>
<div id=breadcrumbs>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<ol class=links itemscope itemtype=http://schema.org/BreadcrumbList>
<meta itemprop=itemListOrder content="Descending">
<li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="4"><a itemprop=item href=/><span itemprop=name>Home</span></a> > </li>
<li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=/game-dev/><span itemprop=name>Game Series</span></a> > </li>
<li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=/game-dev/part-i/><span itemprop=name>Part I</span></a> > </li>
<li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=/game-dev/part-i/towervaliditychecking/ aria-disabled=true><span itemprop=name>Tower Validity Checking</span></a></li>
</ol>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#checking-overlaps>Checking Overlaps</a>
<ul>
<li><a href=#checking-overlaps-with-other-towers>Checking Overlaps With Other Towers</a></li>
<li><a href=#checking-overlaps-with-path>Checking Overlaps With Path</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div id=head-tags>
</div>
<main id=body-inner>
<h1>Tower Validity Checking</h1>
<hr>
<div class="attachments red">
<div class=label>Tower Validity Checking Template</div>
<ul class=attachments-files>
<li><a href=/game-dev/part-i/towervaliditychecking.files/TowerValidityTemplate.zip>TowerValidityTemplate.zip</a> (3 KB)</li>
</ul>
</div>
<h2 id=checking-overlaps>Checking Overlaps</h2>
<p>One of the main things we need to make sure of is that our towers aren&rsquo;t being placed in illegal areas. We don&rsquo;t want a million towers on top of each other or towers that are on our balloon&rsquo;s path. When dragging and dropping our towers, we made sure to show visually whether the tower is in a legal area or not. We split up the validity checking into two parts: checking for overlaps with other towers and checking overlaps with the path.</p>
<h3 id=checking-overlaps-with-other-towers>Checking Overlaps With Other Towers</h3>
<p>To check if there is overlap with other towers, we need to store our towers into an <strong><a href=/game-dev/part-i/pathforballoons/#arraylists>ArrayList</a></strong>. We can use a PVector ArrayList to store the (x, y) coordinates of our towers. The formatting would be the exact same as our ArrayList for storing the path, as shown in Example 1.</p>
<h6 id=example-1>Example 1</h6>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java>ArrayList<span style=color:#f92672>&lt;</span>PVector<span style=color:#f92672>&gt;</span> towers <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;</span>PVector<span style=color:#f92672>&gt;();</span>
towers<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PVector<span style=color:#f92672>(</span>100<span style=color:#f92672>,</span> 200<span style=color:#f92672>));</span>
towers<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PVector<span style=color:#f92672>(</span>150<span style=color:#f92672>,</span> 175<span style=color:#f92672>));</span>
towers<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PVector<span style=color:#f92672>(</span>200<span style=color:#f92672>,</span> 250<span style=color:#f92672>));</span>
</code></pre></div><p>Usually, we would need to store a third element in there representing the size, since we need to know how large the tower is to check for validity. Within Game Dev&rsquo;s code, we only use one size for our tower, so we can set a variable representing the size. Since our towers are squares, we only need one variable for side length rather than two for width and length.</p>
<p>During our drag and drop, we set an <code>x</code> and <code>y</code> variable, which represents our current tower&rsquo;s x and y coordinates. To check for a singular collision between our current tower and one placed on the ground, we can do a rectangle collision check.</p>
<p>In essence, a rectangle collision check tests if the distance between the x and y coordinates are both smaller than the size. In our code, we use half the size to allow for more leeway when dropping towers, but you can use the full size if that suits you better. Example 2 shows our function for detecting rectangle collision.</p>
<h6 id=example-2>Example 2</h6>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>pointRectCollision</span><span style=color:#f92672>(</span><span style=color:#66d9ef>float</span> x1<span style=color:#f92672>,</span> <span style=color:#66d9ef>float</span> y1<span style=color:#f92672>,</span> <span style=color:#66d9ef>float</span> x2<span style=color:#f92672>,</span> <span style=color:#66d9ef>float</span> y2<span style=color:#f92672>,</span> <span style=color:#66d9ef>float</span> size<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
  <span style=color:#75715e>//            --X Distance--               --Y Distance--
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> <span style=color:#f92672>(</span>abs<span style=color:#f92672>(</span>x2 <span style=color:#f92672>-</span> x1<span style=color:#f92672>)</span> <span style=color:#f92672>&lt;=</span> size <span style=color:#f92672>/</span> 2<span style=color:#f92672>)</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>(</span>abs<span style=color:#f92672>(</span>y2 <span style=color:#f92672>-</span> y1<span style=color:#f92672>)</span> <span style=color:#f92672>&lt;=</span> size <span style=color:#f92672>/</span> 2<span style=color:#f92672>);</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>We can automate this similarily to the path. By running a for loop from the beginning to the end of the array, we can check collision for each tower with our current point. This is shown in Example 3.</p>
<h6 id=example-3>Example 3</h6>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=color:#66d9ef>boolean</span> collision <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
<span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> towers<span style=color:#f92672>.</span><span style=color:#a6e22e>size</span><span style=color:#f92672>();</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>pointRectCollision<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>,</span> towers<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>i<span style=color:#f92672>).</span><span style=color:#a6e22e>x</span><span style=color:#f92672>,</span> towers<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>i<span style=color:#f92672>).</span><span style=color:#a6e22e>y</span><span style=color:#f92672>,</span> towerSize<span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
        collision <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><h3 id=checking-overlaps-with-path>Checking Overlaps With Path</h3>
<p>Checking for collision with the path uses the same concept as with the towers. We want to check if each line segment on our path will collide with our tower. Call to mind how we used a <code>PATH_RADIUS</code> variable, representing half of the size of the path. We want to find the shortest distance from the line to our <code>(x, y)</code> point, and check if it is greater than <code>PATH_RADIUS</code>.</p>
<p>To do this, we need to learn how to calculate the shortest distance from a line to any point. Our code borrows code from <a href=https://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment>StackOverflow</a>, so you can go check out the code there.</p>
<p>We can combine the path checking and the tower checking into one boolean function that will be a general check for everything. This is outlined in Example 4:</p>
<h6 id=example-4>Example 4</h6>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=color:#75715e>// Will return if a drop is legal by looking at the shortance distance between the rectangle center and the path.
</span><span style=color:#75715e></span><span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>legalDrop</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
  <span style=color:#75715e>// checking if this tower overlaps any of the already placed towers
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> i <span style=color:#f92672>&lt;</span> towers<span style=color:#f92672>.</span><span style=color:#a6e22e>size</span><span style=color:#f92672>();</span> i<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
    PVector towerLocation <span style=color:#f92672>=</span> towers<span style=color:#f92672>.</span><span style=color:#a6e22e>get</span><span style=color:#f92672>(</span>i<span style=color:#f92672>);</span>
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>pointRectCollision<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>,</span> towerLocation<span style=color:#f92672>.</span><span style=color:#a6e22e>x</span><span style=color:#f92672>,</span> towerLocation<span style=color:#f92672>.</span><span style=color:#a6e22e>y</span><span style=color:#f92672>,</span> towerSize<span style=color:#f92672>))</span> <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
  <span style=color:#f92672>}</span>
  <span style=color:#66d9ef>return</span> shortestDist<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> PVector<span style=color:#f92672>(</span>x<span style=color:#f92672>,</span> y<span style=color:#f92672>))</span> <span style=color:#f92672>&gt;</span> PATH_RADIUS<span style=color:#f92672>;</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>Check out <code>Towers.pde</code> if you want to look at how we handled path and tower collision.</p>
<footer class=footline>
</footer>
</main>
</div>
<div id=navigation>
<a class="nav nav-prev" href=/game-dev/part-i/healthchecking/ title="Health Bar"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/game-dev/part-ii/ title="Part II"><i class="fa fa-chevron-right"></i></a>
</div>
</div>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1638479108></script>
<script src=/js/perfect-scrollbar.min.js?1638479108></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1638479108></script>
<script src=/js/jquery.svg.pan.zoom.js?1638479108></script>
<script src=/js/featherlight.min.js?1638479108></script>
<script src=/js/modernizr.custom-3.6.0.js?1638479108></script>
<script src=/js/mermaid.min.js?1638479108></script>
<script>typeof mermaid!='undefined'&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script>
<script src=/js/relearn.js?1638479108></script>
</body>
</html>